(self.webpackChunksite=self.webpackChunksite||[]).push([[3907],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return u},kt:function(){return h}});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,l=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),p=c(n),h=o,k=p["".concat(s,".").concat(h)]||p[h]||d[h]||l;return n?a.createElement(k,r(r({ref:t},u),{},{components:n})):a.createElement(k,r({ref:t},u))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var l=n.length,r=new Array(l);r[0]=p;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:o,r[1]=i;for(var c=2;c<l;c++)r[c]=n[c];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},6742:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var a=n(9756),o=n(7294),l=n(3727),r=n(2263),i=n(3919),s=n(412),c=(0,o.createContext)({collectLink:function(){}}),u=n(4996),d=n(8780),p=["isNavLink","to","href","activeClassName","isActive","data-noBrokenLinkCheck","autoAddBaseUrl"];var h=function(e){var t,n,h=e.isNavLink,k=e.to,m=e.href,f=e.activeClassName,g=e.isActive,y=e["data-noBrokenLinkCheck"],w=e.autoAddBaseUrl,b=void 0===w||w,N=(0,a.Z)(e,p),v=(0,r.Z)().siteConfig,x=v.trailingSlash,C=v.baseUrl,T=(0,u.C)().withBaseUrl,S=(0,o.useContext)(c),O=k||m,A=(0,i.Z)(O),_=null==O?void 0:O.replace("pathname://",""),R=void 0!==_?(n=_,b&&function(e){return e.startsWith("/")}(n)?T(n):n):void 0;R&&A&&(R=(0,d.applyTrailingSlash)(R,{trailingSlash:x,baseUrl:C}));var P,E=(0,o.useRef)(!1),D=h?l.OL:l.rU,L=s.Z.canUseIntersectionObserver;(0,o.useEffect)((function(){return!L&&A&&null!=R&&window.docusaurus.prefetch(R),function(){L&&P&&P.disconnect()}}),[R,L,A]);var B=null!==(t=null==R?void 0:R.startsWith("#"))&&void 0!==t&&t,z=!R||!A||B;return R&&A&&!B&&!y&&S.collectLink(R),z?o.createElement("a",Object.assign({href:R},O&&!A&&{target:"_blank",rel:"noopener noreferrer"},N)):o.createElement(D,Object.assign({},N,{onMouseEnter:function(){E.current||null==R||(window.docusaurus.preload(R),E.current=!0)},innerRef:function(e){var t,n;L&&e&&A&&(t=e,n=function(){null!=R&&window.docusaurus.prefetch(R)},(P=new window.IntersectionObserver((function(e){e.forEach((function(e){t===e.target&&(e.isIntersecting||e.intersectionRatio>0)&&(P.unobserve(t),P.disconnect(),n())}))}))).observe(t))},to:R||""},h&&{isActive:g,activeClassName:f}))}},3919:function(e,t,n){"use strict";function a(e){return!0===/^(\w*:|\/\/)/.test(e)}function o(e){return void 0!==e&&!a(e)}n.d(t,{b:function(){return a},Z:function(){return o}})},4996:function(e,t,n){"use strict";n.d(t,{C:function(){return l},Z:function(){return r}});var a=n(2263),o=n(3919);function l(){var e=(0,a.Z)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,n=void 0===t?"/":t,l=e.url;return{withBaseUrl:function(e,t){return function(e,t,n,a){var l=void 0===a?{}:a,r=l.forcePrependBaseUrl,i=void 0!==r&&r,s=l.absolute,c=void 0!==s&&s;if(!n)return n;if(n.startsWith("#"))return n;if((0,o.b)(n))return n;if(i)return t+n;var u=n.startsWith(t)?n:t+n.replace(/^\//,"");return c?e+u:u}(l,n,e,t)}}}function r(e,t){return void 0===t&&(t={}),(0,l().withBaseUrl)(e,t)}},9443:function(e,t,n){"use strict";var a=(0,n(7294).createContext)(void 0);t.Z=a},8802:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=t.trailingSlash,a=t.baseUrl;if(e.startsWith("#"))return e;if(void 0===n)return e;var o,l=e.split(/[#?]/)[0],r="/"===l||l===a?l:(o=l,n?function(e){return e.endsWith("/")?e:e+"/"}(o):function(e){return e.endsWith("/")?e.slice(0,-1):e}(o));return e.replace(l,r)}},8780:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.uniq=t.applyTrailingSlash=void 0;var o=n(8802);Object.defineProperty(t,"applyTrailingSlash",{enumerable:!0,get:function(){return a(o).default}});var l=n(9964);Object.defineProperty(t,"uniq",{enumerable:!0,get:function(){return a(l).default}})},9964:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return Array.from(new Set(e))}},2375:function(e,t,n){"use strict";n.d(t,{T:function(){return p},Z:function(){return h}});var a=n(7294),o=n(6742),l=n(5977),r=n(6010),i=n(9443);var s=function(){var e=(0,a.useContext)(i.Z);if(null==e)throw new Error('"useUserPreferencesContext" is used outside of "Layout" component.');return e},c={assemblyscript:"AssemblyScript",c:"C / C++",c3:"C3",d:"D",go:"Go",grain:"Grain",nelua:"Nelua",nim:"Nim",odin:"Odin",penne:"Penne",porth:"Porth",roland:"Roland",rust:"Rust",wat:"WebAssembly Text",zig:"Zig"};function u(e){return"string"==typeof e&&Object.prototype.hasOwnProperty.call(c,e)}function d(e){return(null!=e?e:"").trim().toLowerCase()}function p(e){var t=e.children,n=e.hidden,o=e.className;return a.createElement("div",{hidden:n,className:o},t)}function h(e){var t=a.Children.toArray(e.children),n=t.map((function(e){return e.props.value})),i=function(){var e=s(),t=e.tabGroupChoices,n=e.setTabGroupChoices,o=(0,a.useState)("assemblyscript"),l=o[0],r=o[1],i=function(e){var t=u(e);t?(r(e),n("language",e)):t||console.warn('MultilanguageCode: invalid code-lang received: "'+e+'"')},c=(0,a.useRef)(i);(0,a.useEffect)((function(){c.current=i}));var p="undefined"!=typeof window?window.location.search:"",h=t.language;return(0,a.useLayoutEffect)((function(){var e=d(h);u(e)&&r(e)}),[h]),(0,a.useEffect)((function(){var e=d(new URLSearchParams(p).get("code-lang"));u(e)&&c.current(e)}),[p]),{activeLang:l,updateLang:i}}().activeLang,p=(0,l.k6)(),h=n.includes(i)?i:n.includes("assemblyscript")?"assemblyscript":n[0],k=a.createElement("div",{className:"dropdown dropdown--hoverable dropdown--right"},a.createElement("a",{className:"navbar__link"},c[h]," "),a.createElement("ul",{className:"dropdown__menu text--left"},Object.entries(c).filter((function(e){return n.includes(e[0])})).map((function(e){var t=e[0],n=e[1],l=p.location.pathname+"?code-lang="+t+(p.location.hash||"#no-scroll");return a.createElement("li",{key:t},a.createElement(o.Z,{to:l,replace:!0,className:(0,r.Z)("dropdown__link",t===h&&"dropdown__link--active")},n))}))));return a.createElement("div",null,a.createElement("div",{className:"multilang"},k),a.createElement("div",null,t.map((function(e){return(0,a.cloneElement)(e,{key:e.props.value,hidden:e.props.value!==h})}))))}},7060:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return c},metadata:function(){return u},toc:function(){return d},default:function(){return h}});var a=n(2122),o=n(9756),l=(n(7294),n(3905)),r=n(2375),i=["components"],s={},c="Drawing the Snake",u={unversionedId:"tutorials/snake/drawing-the-snake",id:"tutorials/snake/drawing-the-snake",isDocsHomePage:!1,title:"Drawing the Snake",description:"Drawing the Body",source:"@site/docs/tutorials/snake/drawing-the-snake.md",sourceDirName:"tutorials/snake",slug:"/tutorials/snake/drawing-the-snake",permalink:"/wasm4/docs/tutorials/snake/drawing-the-snake",editUrl:"https://github.com/aduros/wasm4/edit/main/site/docs/tutorials/snake/drawing-the-snake.md",version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Creating the Snake",permalink:"/wasm4/docs/tutorials/snake/creating-the-snake"},next:{title:"Moving the Snake",permalink:"/wasm4/docs/tutorials/snake/moving-the-snake"}},d=[{value:"Drawing the Body",id:"drawing-the-body",children:[]},{value:"Drawing the Head",id:"drawing-the-head",children:[]}],p={toc:d};function h(e){var t=e.components,s=(0,o.Z)(e,i);return(0,l.kt)("wrapper",(0,a.Z)({},p,s,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"drawing-the-snake"},"Drawing the Snake"),(0,l.kt)("h2",{id:"drawing-the-body"},"Drawing the Body"),(0,l.kt)(r.Z,{mdxType:"MultiLanguage"},(0,l.kt)(r.T,{value:"assemblyscript",mdxType:"Page"},(0,l.kt)("p",null,"To draw the snake, you can take advantage of AssemblyScripts ",(0,l.kt)("inlineCode",{parentName:"p"},"forEach")," function.\nTo make it a little easier, it's a good idea to use the ",(0,l.kt)("inlineCode",{parentName:"p"},"rect")," function of WASM-4:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript"},"// rect draws a rectangle. It uses color 1 to fill and color 2 for the outline\nfunction rect(x: i32, y: i32, width: u32, height: u32): void;\n")),(0,l.kt)("p",null,"With that out the way, let's see what a first draft could look like."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript"},"draw(): void {\n    this.body.forEach(part => w4.rect(part.x * 8, part.y * 8, 8, 8))\n}\n")),(0,l.kt)("p",null,"Simply loop through the body and draw it at ",(0,l.kt)("inlineCode",{parentName:"p"},"x * 8")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"y * 8"),". 8 is the width and the height of a single part. On a 160x160 screen, it's big enough to fit snake that is 20*20=400 parts long."),(0,l.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Importing w4")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Keep in mind you need to import ",(0,l.kt)("inlineCode",{parentName:"p"},"w4")," in case your editor doesn't do this for you."))),(0,l.kt)("p",null,"That's all fine, but since there is no instance of the snake, nothing can be drawn. To fix this, simply create a new variable in main and call it's draw function:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript",metastring:"{1,4,14}","{1,4,14}":!0},'import { Point, Snake } from "./snake"\nimport * as w4 from "./wasm4"\n\nconst snake = new Snake()\n\nexport function start(): void {\n    store<u32>(w4.PALETTE, 0xfbf7f3, 0 * sizeof<u32>())\n    store<u32>(w4.PALETTE, 0xe5b083, 1 * sizeof<u32>())\n    store<u32>(w4.PALETTE, 0x426e5d, 2 * sizeof<u32>())\n    store<u32>(w4.PALETTE, 0x20283d, 3 * sizeof<u32>())\n}\n\nexport function update(): void {\n    snake.draw()\n}\n')),(0,l.kt)("p",null,"Creating a global instance of a snake with some default values."),(0,l.kt)("p",null,"After that, simply call the ",(0,l.kt)("inlineCode",{parentName:"p"},"draw")," function of the snake."),(0,l.kt)("p",null,"You should see some green blocks at the top."),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Snake Body",src:n(6898).Z}))),(0,l.kt)(r.T,{value:"c",mdxType:"Page"},(0,l.kt)("p",null,"To draw the snake, we will use a for loop to iterate over the body.\nTo make it a little easier, it's a good idea to use the ",(0,l.kt)("inlineCode",{parentName:"p"},"rect")," function of WASM-4:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-c"},"// rect draws a rectangle. It uses color 1 to fill and color 2 for the outline\nvoid rect (int32_t x, int32_t y, uint32_t width, uint32_t height);\n")),(0,l.kt)("p",null,"With that out the way, let's see what a first draft could look like. Add the following code to ",(0,l.kt)("inlineCode",{parentName:"p"},"snake.c")," and a corresponding declaration to ",(0,l.kt)("inlineCode",{parentName:"p"},"snake.h"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-c"},"void snake_draw(struct snake *snake)\n{\n    *DRAW_COLORS = 0x0043;\n    for(size_t i = 0; i < snake->length; ++i)\n    {\n        rect(snake->body[i].x*8, snake->body[i].y*8,8,8);  \n    }\n}\n")),(0,l.kt)("p",null,"Simply loop through the body and draw it at ",(0,l.kt)("inlineCode",{parentName:"p"},"x*8")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"y*8"),". 8 is the width and the height of a single part. On a 160x160 screen, it's big enough to fit snake that is 20*20=400 parts long."),(0,l.kt)("p",null,"That's all fine, but since there is no instance of the snake, nothing can be drawn. To fix this, simply create a new variable in main and call its draw function:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-c",metastring:"{5,14-19,24}","{5,14-19,24}":!0},'#include "wasm4.h"\n#include "snake.h"\n#include <stdlib.h>\n\nstruct snake snake;\n\nvoid start() \n{\n    PALETTE[0] = 0xfbf7f3;\n    PALETTE[1] = 0xe5b083;\n    PALETTE[2] = 0x426e5d;\n    PALETTE[3] = 0x20283d;\n\n    snake_create(&snake);\n    snake_push(&snake,(struct point){2,0});\n    snake_push(&snake,(struct point){1,0});\n    snake_push(&snake,(struct point){0,0});\n   \n    snake.direction = (struct point){1,0};\n}\n\nvoid update () \n{\n  snake_draw(&snake);\n}\n')),(0,l.kt)("p",null,"Creating a global instance of a snake with some default values."),(0,l.kt)("p",null,"After that, simply call the ",(0,l.kt)("inlineCode",{parentName:"p"},"snake_draw")," function."),(0,l.kt)("p",null,"You should see some green blocks at the top."),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Snake Body",src:n(6898).Z}))),(0,l.kt)(r.T,{value:"d",mdxType:"Page"},(0,l.kt)("p",null,"// TODO")),(0,l.kt)(r.T,{value:"go",mdxType:"Page"},(0,l.kt)("p",null,"To draw the snake, you can take advantage of Go's ",(0,l.kt)("inlineCode",{parentName:"p"},"range")," keyword to loop through the body.\nTo make it a little easier, it's a good idea to use the ",(0,l.kt)("inlineCode",{parentName:"p"},"Rect")," function of WASM-4:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-go"},"// Rect draws a rectangle. It uses color 1 to fill and color 2 for the outline\nfunc Rect(x, y, width, height int)\n")),(0,l.kt)("p",null,"With that out the way, let's see what a first draft could look like."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-go"},"func (s *Snake) Draw() {\n    for _, part := range s.Body {\n        w4.Rect(part.X*8, part.Y*8, 8, 8)\n    }\n}\n")),(0,l.kt)("p",null,"Simply loop through the body and draw it at ",(0,l.kt)("inlineCode",{parentName:"p"},"X*8")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"Y*8"),". 8 is the width and the height of a single part. On a 160x160 screen, it's big enough to fit snake that is 20*20=400 parts long."),(0,l.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Importing cart/w4")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Keep in mind you need to import ",(0,l.kt)("inlineCode",{parentName:"p"},"cart/w4")," in case your editor doesn't do this for you."))),(0,l.kt)("p",null,"That's all fine, but since there is no instance of the snake, nothing can be drawn. To fix this, simply create a new variable in main and call its draw function:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-go",metastring:"{5-14,26}","{5-14,26}":!0},'package main\n\nimport "cart/w4"\n\nvar (\n    snake = &Snake{\n        Body: []Point{\n            {X: 2, Y: 0},\n            {X: 1, Y: 0},\n            {X: 0, Y: 0},\n        },\n        Direction: Point{X: 1, Y: 0},\n    }\n)\n\n//go:export start\nfunc start() {\n    w4.PALETTE[0] = 0xfbf7f3\n    w4.PALETTE[1] = 0xe5b083\n    w4.PALETTE[2] = 0x426e5d\n    w4.PALETTE[3] = 0x20283d\n}\n\n//go:export update\nfunc update() {\n    snake.Draw()\n}\n')),(0,l.kt)("p",null,"Creating a global instance of a snake with some default values."),(0,l.kt)("p",null,'After that, simply call the "Draw" function of the snake.'),(0,l.kt)("p",null,"You should see some green blocks at the top."),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Snake Body",src:n(6898).Z}))),(0,l.kt)(r.T,{value:"nelua",mdxType:"Page"},(0,l.kt)("p",null,"To draw the snake, you can take advantage of nelua's ",(0,l.kt)("inlineCode",{parentName:"p"},"for")," syntax.\nTo make it a little easier, it's a good idea to use the ",(0,l.kt)("inlineCode",{parentName:"p"},"rect")," function of WASM-4:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-lua"},"// rect draws a rectangle. It uses color 1 to fill and color 2 for the outline\nglobal function rect(x: int32, y: int32, width: uint32, height: uint32)\n")),(0,l.kt)("p",null,"With that out the way, let's see what a first draft could look like."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-lua"},"function Snake:draw()\n  for i = 1, #self.body do\n    rect(self.body[i].x * 8, self.body[i].y * 8, 8, 8)\n  end\nend\n")),(0,l.kt)("p",null,"Simply loop through the body and draw it at ",(0,l.kt)("inlineCode",{parentName:"p"},"x * 8")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"y * 8"),". 8 is the width and the height of a single part. On a 160x160 screen, it's big enough to fit snake that is 20*20=400 parts long."),(0,l.kt)("p",null,"That's all fine, but since we haven't initialized the snake, nothing can be drawn. To fix this, simply create a new variable in main and call its draw function:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-lua",metastring:"{2-5, 17}","{2-5,":!0,"17}":!0},'require "wasm4"\nlocal Snake = require "snake"\nlocal Point, Snake = Snake.Point, Snake.Snake\n\nlocal snake = Snake.init()\n\n$PALETTE = {\n  0xfbf7f3,\n  0xe5b083,\n  0x426e5d,\n  0x20283d\n}\n\nlocal function update()\n  snake:draw()\nend\n\n## setup_wasm4_callbacks(update)\n')),(0,l.kt)("p",null,"Creating a global variable of a snake with some default values."),(0,l.kt)("p",null,"After that, simply call the ",(0,l.kt)("inlineCode",{parentName:"p"},"draw")," function of the snake."),(0,l.kt)("p",null,"You should see some green blocks at the top."),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Snake Body",src:n(6898).Z}))),(0,l.kt)(r.T,{value:"nim",mdxType:"Page"},(0,l.kt)("p",null,"// TODO")),(0,l.kt)(r.T,{value:"odin",mdxType:"Page"},(0,l.kt)("p",null,"// TODO")),(0,l.kt)(r.T,{value:"porth",mdxType:"Page"},(0,l.kt)("p",null,"// TODO")),(0,l.kt)(r.T,{value:"rust",mdxType:"Page"},(0,l.kt)("p",null,"We'll add a new function ",(0,l.kt)("inlineCode",{parentName:"p"},"draw")," inside ",(0,l.kt)("inlineCode",{parentName:"p"},"Snake")," implementation."),(0,l.kt)("p",null,"To make it a little easier, it's a good idea to use the ",(0,l.kt)("inlineCode",{parentName:"p"},"rect")," function of WASM-4\nthat is already defined in ",(0,l.kt)("inlineCode",{parentName:"p"},"src/lib/wasm4.rs"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-rust"},"// rect draws a rectangle. It uses color 1 to fill and color 2 for the outline\npub fn rect(x: i32, y: i32, width: u32, height: u32);\n")),(0,l.kt)("p",null,"Simply loop through the body and draw it at ",(0,l.kt)("inlineCode",{parentName:"p"},"x * 8")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"y * 8")," because our snake is made of 8x8 squares."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-rust"},"// src/snake.rs inside `impl Snake {}` block\npub fn draw(&self) {\n    for &Point { x, y } in self.body.iter() {\n        wasm4::rect(x * 8, y * 8, 8, 8);\n    }\n}\n")),(0,l.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Importing wasm4")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Keep in mind you need to import ",(0,l.kt)("inlineCode",{parentName:"p"},"wasm4"),", in case your editor doesn't do this for you."),(0,l.kt)("pre",{parentName:"div"},(0,l.kt)("code",{parentName:"pre",className:"language-rust"},"use crate::wasm4;\n")))),(0,l.kt)("hr",null),(0,l.kt)("p",null,"That's all fine, but since there is no instance of the snake, nothing can be drawn. To fix this we are going to define a ",(0,l.kt)("inlineCode",{parentName:"p"},"Game")," struct\ninside ",(0,l.kt)("inlineCode",{parentName:"p"},"src/game.rs"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-rust"},"// src/game.rs\nuse crate::snake::{Point, Snake};\nuse crate::wasm4;\n\npub struct Game {\n    snake: Snake,\n}\n\nimpl Game {\n    pub fn new() -> Self {\n      Self {\n          snake: Snake::new(),\n      }\n    }\n\n    pub fn update(&self) {\n        self.snake.draw();\n    }\n}\n")),(0,l.kt)("p",null,"We'll store a global ",(0,l.kt)("inlineCode",{parentName:"p"},"Game")," instance using ",(0,l.kt)("a",{parentName:"p",href:"https://doc.rust-lang.org/std/sync/struct.Mutex.html"},(0,l.kt)("inlineCode",{parentName:"a"},"Mutex")),", provided by the standard library, and the macro ",(0,l.kt)("a",{parentName:"p",href:"https://crates.io/crates/lazy_static"},(0,l.kt)("inlineCode",{parentName:"a"},"lazy_static"))," from ",(0,l.kt)("a",{parentName:"p",href:"https://crates.io/"},"crates.io"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-rust"},'// src/lib.rs\n#[cfg(feature = "buddy-alloc")]\nmod alloc;\nmod game;\nmod palette;\nmod snake;\nmod wasm4;\nuse game::Game;\nuse lazy_static::lazy_static;\nuse std::sync::Mutex;\n\nlazy_static! {\n    static ref SNAKE_GAME: Mutex<Game> = Mutex::new(Game::new());\n}\n\n#[no_mangle]\nfn start() {\n    palette::set_palette([0xfff6d3, 0xf9a875, 0xeb6b6f, 0x7c3f58]);\n}\n\n#[no_mangle]\nfn update() {\n    SNAKE_GAME.lock().expect("game_state").update();\n}\n')),(0,l.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Using external libraries")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},(0,l.kt)("a",{parentName:"p",href:"https://crates.io/crates/lazy_static"},(0,l.kt)("inlineCode",{parentName:"a"},"lazy_static"))," is an external library:"),(0,l.kt)("p",{parentName:"div"},"we have to declare inside the ",(0,l.kt)("inlineCode",{parentName:"p"},"dependencies")," section of ",(0,l.kt)("inlineCode",{parentName:"p"},"Cargo.toml"),", otherwise ",(0,l.kt)("inlineCode",{parentName:"p"},"rustc")," does not know how to resolve it and will\nnot compile our game."),(0,l.kt)("pre",{parentName:"div"},(0,l.kt)("code",{parentName:"pre",className:"language-toml",metastring:"{3}","{3}":!0},'[dependencies]\nbuddy-alloc = { version = "0.4.1", optional = true }\nlazy_static = "1.4.0"\n')),(0,l.kt)("p",{parentName:"div"},"See also:"),(0,l.kt)("ul",{parentName:"div"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://doc.rust-lang.org/book/ch02-00-guessing-game-tutorial.html?highlight=dependencies#using-a-crate-to-get-more-functionality"},"using crates(rustbook)")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://doc.rust-lang.org/cargo/guide/dependencies.html#adding-a-dependency"},"add a dependency(cargobook)")))))),(0,l.kt)(r.T,{value:"wat",mdxType:"Page"},(0,l.kt)("p",null,"To draw the snake, you can loop through each point using the ",(0,l.kt)("inlineCode",{parentName:"p"},"loop")," instruction. To make it a little easier, it's a good idea to use the ",(0,l.kt)("inlineCode",{parentName:"p"},"Rect")," function of WASM-4:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-wasm"},';; Rect draws a rectangle. It uses color 1 to fill and color 2 for the outline\n(import "env" "rect" (func $rect (param i32 i32 i32 i32)))\n')),(0,l.kt)("p",null,"With that out the way, let's see what a first draft could look like. In the WebAssembly text format, it's often simpler to use an address directly rather than an array index. However, since we know that the array starts at 0x19ac, we can use that as a direct index in the load instructions. So we'll actually use a byte offset to access each point of the snake."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-wasm"},"(func $snake-draw\n  (local $offset i32)      ;; offset is initialized to 0\n  (local $offset-end i32)\n\n  ;; offset-end = body_length * 8\n  (local.set $offset-end\n    (i32.mul\n      (i32.load (i32.const 0x19a8))  ;; body_length\n      (i32.const 8)))\n\n  ;; loop over all points in the body\n  (loop $loop\n    ;; rect(part.x * 8, part.y * 8, 8, 8)\n    ;; \n    ;; Note that the array starts at 0x19ac, so the first x-coordinate starts\n    ;; at 0x19ac and the first y-coordinate starts at 0x19b0. We can bake these\n    ;; offsets directly into the instruction to reduce the code size.\n    (call $rect\n      (i32.mul (i32.load offset=0x19ac (local.get $offset)) (i32.const 8))\n      (i32.mul (i32.load offset=0x19b0 (local.get $offset)) (i32.const 8))\n      (i32.const 8)\n      (i32.const 8))\n\n    ;; Add 8 to offset, and loop if offset < offset-end.\n    (br_if $loop\n      (i32.lt_u\n        (local.tee $offset (i32.add (local.get $offset) (i32.const 8)))\n        (local.get $offset-end)))\n  )\n)\n")),(0,l.kt)("p",null,"Simply loop through the body and draw it at ",(0,l.kt)("inlineCode",{parentName:"p"},"x * 8")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"y * 8"),". 8 is the width and the height of a single part. On a 160x160 screen, it's big enough to fit snake that is 20*20=400 parts long."),(0,l.kt)("p",null,"That's all fine, but nothing will be drawn until we call this function from ",(0,l.kt)("inlineCode",{parentName:"p"},"update"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-wasm"},'(func (export "update")\n  (call $snake-draw)\n)\n')),(0,l.kt)("p",null,"You should see some green blocks at the top."),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Snake Body",src:n(6898).Z}))),(0,l.kt)(r.T,{value:"zig",mdxType:"Page"},(0,l.kt)("p",null,"To draw the snake, you can take advantage of zig's ",(0,l.kt)("inlineCode",{parentName:"p"},"for")," syntax.\nTo make it a little easier, it's a good idea to use the ",(0,l.kt)("inlineCode",{parentName:"p"},"rect")," function of WASM-4:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-zig"},"// rect draws a rectangle. It uses color 1 to fill and color 2 for the outline\nfn rect(x: i32, y: i32, width: u32, height: u32) void;\n")),(0,l.kt)("p",null,"With that out the way, let's see what a first draft could look like."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-zig",metastring:"{2,9-13}","{2,9-13}":!0},'// Add this to the top of the file\nconst w4 = @import("wasm4.zig");\n\n// ...\n\npub const Snake = struct {\n    // ...\n\n    pub fn draw(this: *@This()) void {\n        for(this.body.constSlice()) |part| {\n            w4.rect(part.x * 8, part.y * 8, 8, 8);\n        }\n    }\n}\n')),(0,l.kt)("p",null,"Simply loop through the body and draw it at ",(0,l.kt)("inlineCode",{parentName:"p"},"x * 8")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"y * 8"),". 8 is the width and the height of a single part. On a 160x160 screen, it's big enough to fit snake that is 20*20=400 parts long. This is where the 400 in the BoundedArray declaration comes from: we cap the number of elements to 400 at comptime so we don't have to deal with dynamically allocating memory for the points."),(0,l.kt)("p",null,"That's all fine, but since we haven't initialized the snake, nothing can be drawn. To fix this, simply create a new variable in main and call its draw function:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-zig",metastring:"{2,4,16}","{2,4,16}":!0},'const w4 = @import("wasm4.zig");\nconst Snake = @import("snake.zig").Snake;\n\nvar snake = Snake.init();\n\nexport fn start() void {\n    w4.PALETTE.* = .{\n        0xfbf7f3,\n        0xe5b083,\n        0x426e5d,\n        0x20283d,\n    };\n}\n\nexport fn update() void {\n    snake.draw();\n}\n')),(0,l.kt)("p",null,"This creating a global variable of a snake with some default values."),(0,l.kt)("p",null,"After that, simply call the ",(0,l.kt)("inlineCode",{parentName:"p"},"draw")," function of the snake."),(0,l.kt)("p",null,"You should see some green blocks at the top."),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Snake Body",src:n(6898).Z})))),(0,l.kt)("h2",{id:"drawing-the-head"},"Drawing the Head"),(0,l.kt)(r.Z,{mdxType:"MultiLanguage"},(0,l.kt)(r.T,{value:"assemblyscript",mdxType:"Page"},(0,l.kt)("p",null,"But where is the head? You can pick a side. Either position ",(0,l.kt)("inlineCode",{parentName:"p"},"[0]")," or position ",(0,l.kt)("inlineCode",{parentName:"p"},"[this.body.length - 1]"),"."),(0,l.kt)("p",null,"I think it's easier to pick ",(0,l.kt)("inlineCode",{parentName:"p"},"[0]"),"."),(0,l.kt)("p",null,"Since the body is drawn, head is not much of a problem. Simply use the ",(0,l.kt)("inlineCode",{parentName:"p"},"rect")," function again. But use a specific part instead:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript"},"    w4.rect(this.body[0].x * 8, this.body[0].y * 8, 8, 8)\n")),(0,l.kt)("p",null,"The draw function should now look like this:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript",metastring:"{3}","{3}":!0},"draw(): void {\n    this.body.forEach(part => w4.rect(part.x * 8, part.y * 8, 8, 8))\n    w4.rect(this.body[0].x * 8, this.body[0].y * 8, 8, 8)\n}\n")),(0,l.kt)("p",null,"Notice the difference? Me neither."),(0,l.kt)("p",null,"The head should stand out a little. For this, you can use a different color:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript"},"store<u16>(w4.DRAW_COLORS, 0x0004)\n")),(0,l.kt)("p",null,"You can set the colors with this variable. You can look at this variable like a table that is read from right to left."),(0,l.kt)("p",null,"The value for each digit can be  0 up to 4:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"0 = Use transparency"),(0,l.kt)("li",{parentName:"ul"},"1 = Use the 1st color from the color palette"),(0,l.kt)("li",{parentName:"ul"},"2 = Use the 2nd color from the color palette"),(0,l.kt)("li",{parentName:"ul"},"3 = Use the 3rd color from the color palette"),(0,l.kt)("li",{parentName:"ul"},"4 = Use the 4th color from the color palette")),(0,l.kt)("p",null,'The snippet above reads like this: "Color 1 uses Color 4 of the color palette, Color 2 to Color 4 don\'t use any color." The basic drawing functions use "Color 1" to fill the shape and "Color 2" for the border.'),(0,l.kt)("p",null,"If you change the source to"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript",metastring:"{4}","{4}":!0},"draw(): void {\n    this.body.forEach(part => w4.rect(part.x * 8, part.y * 8, 8, 8))\n\n    store<u16>(w4.DRAW_COLORS, 0x0004)\n    w4.rect(this.body[0].x * 8, this.body[0].y * 8, 8, 8)\n}\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Changing Color",src:n(7882).Z})),(0,l.kt)("p",null,"You'll see a change. The snake changed color. Not only the head, but the complete snake! Once you've set a color, it stays that way. So if you want to change only the head, you have to change Color 1 again. Right before you draw the body."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript",metastring:"{2}","{2}":!0},"draw(): void {\n    store<u16>(w4.DRAW_COLORS, 0x0043)\n    this.body.forEach(part => w4.rect(part.x * 8, part.y * 8, 8, 8))\n\n    store<u16>(w4.DRAW_COLORS, 0x0004)\n    w4.rect(this.body[0].x * 8, this.body[0].y * 8, 8, 8)\n}\n")),(0,l.kt)("p",null,"This changes the color back and adds the darker green as its outline."),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Snake with outline",src:n(2179).Z}))),(0,l.kt)(r.T,{value:"c",mdxType:"Page"},(0,l.kt)("p",null,"But where is the head? You can pick a side. Either position ",(0,l.kt)("inlineCode",{parentName:"p"},"[0]")," or position ",(0,l.kt)("inlineCode",{parentName:"p"},"[snake->length-1]"),"."),(0,l.kt)("p",null,"I think it's easier to pick ",(0,l.kt)("inlineCode",{parentName:"p"},"[0]"),"."),(0,l.kt)("p",null,"Since the body is drawn, head is not much of a problem. Simply use the ",(0,l.kt)("inlineCode",{parentName:"p"},"rect")," function again. But use a specific part instead:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-c"},"rect(snake->body[0].x*8,snake->body[0].y*8,8,8);\n")),(0,l.kt)("p",null,"The draw function should now look like this:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-c",metastring:"{8}","{8}":!0},"void snake_draw(struct snake *snake)\n{\n    for(size_t i = 0; i < snake->length; ++i)\n    {\n        rect(snake->body[i].x*8, snake->body[i].y*8,8,8);  \n    }\n\n    rect(snake->body[0].x*8,snake->body[0].y*8,8,8);\n}\n")),(0,l.kt)("p",null,"Notice the difference? Me neither."),(0,l.kt)("p",null,"The head should stand out a little. For this, you can use a different color:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-c"},"*DRAW_COLORS = 0x0004;\n")),(0,l.kt)("p",null,"You can set the colors with this variable. You can look at this variable like a table that is read from right to left."),(0,l.kt)("p",null,"The value for each digit can be  0 up to 4:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"0 = Use transparency"),(0,l.kt)("li",{parentName:"ul"},"1 = Use the 1st color from the color palette"),(0,l.kt)("li",{parentName:"ul"},"2 = Use the 2nd color from the color palette"),(0,l.kt)("li",{parentName:"ul"},"3 = Use the 3rd color from the color palette"),(0,l.kt)("li",{parentName:"ul"},"4 = Use the 4th color from the color palette")),(0,l.kt)("p",null,'The snippet above reads like this: "Color 1 uses Color 4 of the color palette, Color 2 to Color 4 don\'t use any color." The basic drawing functions use "Color 1" to fill the shape and "Color 2" for the border.'),(0,l.kt)("p",null,"If you change the source to:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-c",metastring:"{8}","{8}":!0},"void snake_draw(struct snake *snake)\n{\n    for(size_t i = 0; i < snake->length; ++i)\n    {\n        rect(snake->body[i].x*8, snake->body[i].y*8,8,8);  \n    }\n\n    *DRAW_COLORS = 0x0004;\n    rect(snake->body[0].x*8,snake->body[0].y*8,8,8);\n}\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Changing Color",src:n(7882).Z})),(0,l.kt)("p",null,"You'll see a change. The snake changed color. Not only the head, but the complete snake! Once you've set a color, it stays that way. So if you want to change only the head, you have to change Color 1 again. Right before you draw the body."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-c",metastring:"{3}","{3}":!0},"void snake_draw(struct snake *snake)\n{\n    *DRAW_COLORS = 0x0043;\n    for(size_t i = 0; i < snake->length; ++i)\n    {\n        rect(snake->body[i].x*8, snake->body[i].y*8,8,8);  \n    }\n\n    *DRAW_COLORS = 0x0004;\n    rect(snake->body[0].x*8,snake->body[0].y*8,8,8);\n}\n")),(0,l.kt)("p",null,"This changes the color back and adds the darker green as its outline."),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Snake with outline",src:n(2179).Z}))),(0,l.kt)(r.T,{value:"d",mdxType:"Page"},(0,l.kt)("p",null,"// TODO")),(0,l.kt)(r.T,{value:"go",mdxType:"Page"},(0,l.kt)("p",null,"But where is the head? You can pick a side. Either position ",(0,l.kt)("inlineCode",{parentName:"p"},"[0]")," or position ",(0,l.kt)("inlineCode",{parentName:"p"},"[len(snake)-1]"),"."),(0,l.kt)("p",null,"I think it's easier to pick ",(0,l.kt)("inlineCode",{parentName:"p"},"[0]"),"."),(0,l.kt)("p",null,"Since the body is drawn, head is not much of a problem. Simply use the ",(0,l.kt)("inlineCode",{parentName:"p"},"Rect")," function again. But use a specific part instead:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-go"},"    w4.Rect(s.Body[0].X*8, s.Body[0].Y*8, 8, 8)\n")),(0,l.kt)("p",null,"The draw function should now look like this:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-go",metastring:"{6}","{6}":!0},"func (s *Snake) Draw() {\n    for _, part := range s.Body {\n        w4.Rect(part.X*8, part.Y*8, 8, 8)\n    }\n\n    w4.Rect(s.Body[0].X*8, s.Body[0].Y*8, 8, 8)\n}\n")),(0,l.kt)("p",null,"Notice the difference? Me neither."),(0,l.kt)("p",null,"The head should stand out a little. For this, you can use a different color:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-go"},"*w4.DRAW_COLORS = 0x0004\n")),(0,l.kt)("p",null,"You can set the colors with this variable. You can look at this variable like a table that is read from right to left."),(0,l.kt)("p",null,"The value for each digit can be  0 up to 4:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"0 = Use transparency"),(0,l.kt)("li",{parentName:"ul"},"1 = Use the 1st color from the color palette"),(0,l.kt)("li",{parentName:"ul"},"2 = Use the 2nd color from the color palette"),(0,l.kt)("li",{parentName:"ul"},"3 = Use the 3rd color from the color palette"),(0,l.kt)("li",{parentName:"ul"},"4 = Use the 4th color from the color palette")),(0,l.kt)("p",null,'The snippet above reads like this: "Color 1 uses Color 4 of the color palette, Color 2 to Color 4 don\'t use any color." The basic drawing functions use "Color 1" to fill the shape and "Color 2" for the border.'),(0,l.kt)("p",null,"If you change the source to"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-go",metastring:"{6}","{6}":!0},"func (s *Snake) Draw() {\n    for _, part := range s.Body {\n        w4.Rect(part.X*8, part.Y*8, 8, 8)\n    }\n\n    *w4.DRAW_COLORS = 0x0004\n    w4.Rect(s.Body[0].X*8, s.Body[0].Y*8, 8, 8)\n}\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Changing Color",src:n(7882).Z})),(0,l.kt)("p",null,"You'll see a change. The snake changed color. Not only the head, but the complete snake! Once you've set a color, it stays that way. So if you want to change only the head, you have to change Color 1 again. Right before you draw the body."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-go",metastring:"{2}","{2}":!0},"func (s *Snake) Draw() {\n    *w4.DRAW_COLORS = 0x0043\n    for _, part := range s.Body {\n        w4.Rect(part.X*8, part.Y*8, 8, 8)\n    }\n\n    *w4.DRAW_COLORS = 0x0004\n    w4.Rect(s.Body[0].X*8, s.Body[0].Y*8, 8, 8)\n}\n")),(0,l.kt)("p",null,"This changes the color back and adds the darker green as its outline."),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Snake with outline",src:n(2179).Z}))),(0,l.kt)(r.T,{value:"nelua",mdxType:"Page"},(0,l.kt)("p",null,"But where is the head? You can pick a side. Either position ",(0,l.kt)("inlineCode",{parentName:"p"},"[1]")," or position ",(0,l.kt)("inlineCode",{parentName:"p"},"[#self.body]"),"."),(0,l.kt)("p",null,"I think it's easier to pick ",(0,l.kt)("inlineCode",{parentName:"p"},"[1]"),"."),(0,l.kt)("p",null,"Since the body is drawn, head is not much of a problem. Simply use the ",(0,l.kt)("inlineCode",{parentName:"p"},"rect")," function again. But use a specific part instead:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-lua"},"  rect(self.body[1].x * 8, self.body[1].y * 8, 8, 8)\n")),(0,l.kt)("p",null,"The draw function should now look like this:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-lua",metastring:"{7}","{7}":!0},"function Snake:draw()\n  for i = 1, #self.body do\n    rect(self.body[i].x * 8, self.body[i].y * 8, 8, 8)\n  end\n\n  rect(self.body[1].x * 8, self.body[1].y * 8, 8, 8)\nend\n")),(0,l.kt)("p",null,"Notice the difference? Me neither."),(0,l.kt)("p",null,"The head should stand out a little. For this, you can use a different color:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-lua"},"$DRAW_COLORS = 0x0004;\n")),(0,l.kt)("p",null,"You can set the colors with this variable. You can look at this variable like a table that is read from right to left."),(0,l.kt)("p",null,"The value for each digit can be  0 up to 4:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"0 = Use transparency"),(0,l.kt)("li",{parentName:"ul"},"1 = Use the 1st color from the color palette"),(0,l.kt)("li",{parentName:"ul"},"2 = Use the 2nd color from the color palette"),(0,l.kt)("li",{parentName:"ul"},"3 = Use the 3rd color from the color palette"),(0,l.kt)("li",{parentName:"ul"},"4 = Use the 4th color from the color palette")),(0,l.kt)("p",null,'The snippet above reads like this: "Color 1 uses Color 4 of the color palette, Color 2 to Color 4 don\'t use any color." The basic drawing functions use "Color 1" to fill the shape and "Color 2" for the border.'),(0,l.kt)("p",null,"If you change the source to"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-lua",metastring:"{7}","{7}":!0},"function Snake:draw()\n  for i = 1, #self.body do\n    rect(self.body[i].x * 8, self.body[i].y * 8, 8, 8)\n  end\n\n  $DRAW_COLORS = 0x0004;\n  rect(self.body[1].x * 8, self.body[1].y * 8, 8, 8)\nend\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Changing Color",src:n(7882).Z})),(0,l.kt)("p",null,"You'll see a change. The snake changed color. Not only the head, but the complete snake! Once you've set a color, it stays that way. So if you want to change only the head, you have to change Color 1 again. Right before you draw the body."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-lua",metastring:"{2}","{2}":!0},"function Snake:draw()\n  $DRAW_COLORS = 0x0043;\n  for i = 1, #self.body do\n    rect(self.body[i].x * 8, self.body[i].y * 8, 8, 8)\n  end\n\n  $DRAW_COLORS = 0x0004;\n  rect(self.body[1].x * 8, self.body[1].y * 8, 8, 8)\nend\n")),(0,l.kt)("p",null,"This changes the color back and adds the darker green as its outline."),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Snake with outline",src:n(2179).Z}))),(0,l.kt)(r.T,{value:"nim",mdxType:"Page"},(0,l.kt)("p",null,"// TODO")),(0,l.kt)(r.T,{value:"odin",mdxType:"Page"},(0,l.kt)("p",null,"// TODO")),(0,l.kt)(r.T,{value:"porth",mdxType:"Page"},(0,l.kt)("p",null,"// TODO")),(0,l.kt)(r.T,{value:"rust",mdxType:"Page"},(0,l.kt)("p",null,"But where is the head? You can pick a side. Either position ",(0,l.kt)("inlineCode",{parentName:"p"},"0")," or position ",(0,l.kt)("inlineCode",{parentName:"p"},"self.body.len() - 1"),".\nI think it's easier to pick ",(0,l.kt)("inlineCode",{parentName:"p"},"0"),"."),(0,l.kt)("p",null,"Since the body is drawn, head is not much of a problem. Simply use the ",(0,l.kt)("inlineCode",{parentName:"p"},"rect")," function again. But use a specific part instead:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-rust",metastring:"{7}","{7}":!0},"// src/snake.r` inside `impl Snake {}` block\npub fn draw(&self) {\n    for &Point { x, y } in self.body.iter() {\n        wasm4::rect(x * 8, y * 8, 8, 8);\n    }\n\n    wasm4::rect(self.body[0].x * 8, self.body[0].y * 8, 8, 8);\n}\n")),(0,l.kt)("p",null,"Notice the difference? Me neither.\nThe head should stand out a little. For this, you can use a different color."),(0,l.kt)("p",null,"We'll create a helper function inside ",(0,l.kt)("inlineCode",{parentName:"p"},"src/palette.rs")," to confine the ",(0,l.kt)("inlineCode",{parentName:"p"},"unsafe")," code."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-rust"},"// src/palette.rs\npub fn set_draw_color(idx: u16) {\n    unsafe { *wasm4::DRAW_COLORS = idx.into() }\n}\n")),(0,l.kt)("p",null,"Then we'll invoke ",(0,l.kt)("inlineCode",{parentName:"p"},"draw_color")," inside ",(0,l.kt)("inlineCode",{parentName:"p"},"src/snake.rs"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-rust",metastring:"{2,10}","{2,10}":!0},"// src/snake.rs\nuse crate::palette::set_draw_color;\n\n// Inside inside `impl Snake {}` block\npub fn draw(&self) {\n    for &Point { x, y } in self.body.iter() {\n        wasm4::rect(x * 8, y * 8, 8, 8);\n    }\n\n    set_draw_color(0x4);\n    wasm4::rect(self.body[0].x * 8, self.body[0].y * 8, 8, 8);\n}\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Changing Color",src:n(7882).Z})),(0,l.kt)("p",null,"You'll see a change. The snake changed color. Not only the head, but the complete snake! Once you've set a color, it stays that way. So if you want to change only the head, you have to change color 1 again. Right before you draw the body."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-rust",metastring:"{6}","{6}":!0},"// src/snake.rs\nuse crate::palette::set_draw_color;\n\n// Inside inside `impl Snake {}` block\npub fn draw(&self) {\n    set_draw_color(0x43);\n\n    for &Point { x, y } in self.body.iter() {\n        wasm4::rect(x * 8, y * 8, 8, 8);\n    }\n\n    set_draw_color(0x4);\n    wasm4::rect(self.body[0].x * 8, self.body[0].y * 8, 8, 8);\n}\n")),(0,l.kt)("p",null,"This changes the color back and adds the darker green as its outline."),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Snake with outline",src:n(2179).Z}))),(0,l.kt)(r.T,{value:"wat",mdxType:"Page"},(0,l.kt)("p",null,"But where is the head? You can pick a side. Either position ",(0,l.kt)("inlineCode",{parentName:"p"},"[0]")," or position ",(0,l.kt)("inlineCode",{parentName:"p"},"[body_length - 1]"),"."),(0,l.kt)("p",null,"I think it's easier to pick ",(0,l.kt)("inlineCode",{parentName:"p"},"[0]"),"."),(0,l.kt)("p",null,"Since the body is drawn, head is not much of a problem. Simply use the ",(0,l.kt)("inlineCode",{parentName:"p"},"rect")," function again. But use a specific part instead:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-wasm"},"(call $rect\n  (i32.mul (i32.load (i32.const 0x19ac)) (i32.const 8))\n  (i32.mul (i32.load (i32.const 0x19b0)) (i32.const 8))\n  (i32.const 8)\n  (i32.const 8))\n")),(0,l.kt)("p",null,"The draw function should now look like this:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-wasm"},"(func $snake-draw\n  (local $offset i32)      ;; offset is initialized to 0\n  (local $offset-end i32)\n\n  ;; offset-end = body_length * 8\n  (local.set $offset-end\n    (i32.mul\n      (i32.load (i32.const 0x19a8))  ;; body_length\n      (i32.const 8)))\n\n  ;; loop over all points in the body\n  (loop $loop\n    ;; rect(part.x * 8, part.y * 8, 8, 8)\n    ;; \n    ;; Note that the array starts at 0x19a4, so the first x-coordinate starts\n    ;; at 0x19a4 and the first y-coordinate starts at 0x19a8. We can bake these\n    ;; offsets directly into the instruction to reduce the code size.\n    (call $rect\n      (i32.mul (i32.load offset=0x19ac (local.get $offset)) (i32.const 8))\n      (i32.mul (i32.load offset=0x19b0 (local.get $offset)) (i32.const 8))\n      (i32.const 8)\n      (i32.const 8))\n\n    ;; Add 8 to offset, and loop if offset < offset-end.\n    (br_if $loop\n      (i32.lt_u\n        (local.tee $offset (i32.add (local.get $offset) (i32.const 8)))\n        (local.get $offset-end)))\n  )\n\n  ;; Draw the head.\n  (call $rect\n    (i32.mul (i32.load (i32.const 0x19ac)) (i32.const 8))\n    (i32.mul (i32.load (i32.const 0x19b0)) (i32.const 8))\n    (i32.const 8)\n    (i32.const 8))\n)\n")),(0,l.kt)("p",null,"Notice the difference? Me neither."),(0,l.kt)("p",null,"The head should stand out a little. For this, you can use a different color:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-wasm"},"  (i32.store16 (global.get $DRAW_COLORS) (i32.const 0x0004))\n")),(0,l.kt)("p",null,"You can set the colors with this variable. You can look at this variable like a table that is read from right to left."),(0,l.kt)("p",null,"The value for each digit can be  0 up to 4:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"0 = Use transparency"),(0,l.kt)("li",{parentName:"ul"},"1 = Use the 1st color from the color palette"),(0,l.kt)("li",{parentName:"ul"},"2 = Use the 2nd color from the color palette"),(0,l.kt)("li",{parentName:"ul"},"3 = Use the 3rd color from the color palette"),(0,l.kt)("li",{parentName:"ul"},"4 = Use the 4th color from the color palette")),(0,l.kt)("p",null,'The snippet above reads like this: "Color 1 uses Color 4 of the color palette, Color 2 to Color 4 don\'t use any color." The basic drawing functions use "Color 1" to fill the shape and "Color 2" for the border.'),(0,l.kt)("p",null,"If you change the source to"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-wasm"},"(func $snake-draw\n  ...\n\n  ;; Set the head color.\n  (i32.store16 (global.get $DRAW_COLORS) (i32.const 0x0004))\n\n  ;; Draw the head.\n  (call $rect\n    (i32.mul (i32.load (i32.const 0x19ac)) (i32.const 8))\n    (i32.mul (i32.load (i32.const 0x19b0)) (i32.const 8))\n    (i32.const 8)\n    (i32.const 8))\n)\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Changing Color",src:n(7882).Z})),(0,l.kt)("p",null,"You'll see a change. The snake changed color. Not only the head, but the complete snake! Once you've set a color, it stays that way. So if you want to change only the head, you have to change Color 1 again. Right before you draw the body."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-wasm"},"(func $snake-draw\n  ;; Set the body color.\n  (i32.store16 (global.get $DRAW_COLORS) (i32.const 0x0043))\n  ...\n\n  ;; Set the head color.\n  (i32.store16 (global.get $DRAW_COLORS) (i32.const 0x0004))\n\n  ;; Draw the head.\n  (call $rect\n    (i32.mul (i32.load (i32.const 0x19ac)) (i32.const 8))\n    (i32.mul (i32.load (i32.const 0x19b0)) (i32.const 8))\n    (i32.const 8)\n    (i32.const 8))\n)\n")),(0,l.kt)("p",null,"This changes the color back and adds the darker green as it's outline."),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Snake with outline",src:n(2179).Z}))),(0,l.kt)(r.T,{value:"zig",mdxType:"Page"},(0,l.kt)("p",null,"But where is the head? You can pick a side. Either position ",(0,l.kt)("inlineCode",{parentName:"p"},"[0]")," or position ",(0,l.kt)("inlineCode",{parentName:"p"},"[this.body.length - 1]"),"."),(0,l.kt)("p",null,"I think it's easier to pick ",(0,l.kt)("inlineCode",{parentName:"p"},"[0]"),"."),(0,l.kt)("p",null,"Since the body is drawn, head is not much of a problem. Simply use the ",(0,l.kt)("inlineCode",{parentName:"p"},"rect")," function again. But use a specific part instead:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-zig"},"    w4.rect(this.body.get(0).x * 8, this.body.get(0).y * 8, 8, 8)\n")),(0,l.kt)("p",null,"The draw function should now look like this:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-zig",metastring:"{6}","{6}":!0},"pub fn draw(this: *@This()) void {\n    for(this.body.constSlice()) |part| {\n        w4.rect(part.x * 8, part.y * 8, 8, 8);\n    }\n\n    w4.rect(this.body.get(0).x * 8, this.body.get(0).y * 8, 8, 8);\n}\n")),(0,l.kt)("p",null,"Notice the difference? Me neither."),(0,l.kt)("p",null,"The head should stand out a little. For this, you can use a different color:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-zig"},"w4.DRAW_COLORS.* = 0x0004;\n")),(0,l.kt)("p",null,"You can set the colors with this variable. You can look at this variable like a table that is read from right to left."),(0,l.kt)("p",null,"The value for each digit can be  0 up to 4:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"0 = Use transparency"),(0,l.kt)("li",{parentName:"ul"},"1 = Use the 1st color from the color palette"),(0,l.kt)("li",{parentName:"ul"},"2 = Use the 2nd color from the color palette"),(0,l.kt)("li",{parentName:"ul"},"3 = Use the 3rd color from the color palette"),(0,l.kt)("li",{parentName:"ul"},"4 = Use the 4th color from the color palette")),(0,l.kt)("p",null,'The snippet above reads like this: "Color 1 uses Color 4 of the color palette, Color 2 to Color 4 don\'t use any color." The basic drawing functions use "Color 1" to fill the shape and "Color 2" for the border.'),(0,l.kt)("p",null,"If you change the source to"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-zig",metastring:"{6}","{6}":!0},"pub fn draw(this: *@This()) void {\n    for(this.body.constSlice()) |part| {\n        w4.rect(part.x * 8, part.y * 8, 8, 8);\n    }\n\n    w4.DRAW_COLORS.* = 0x0004;\n    w4.rect(this.body.get(0).x * 8, this.body.get(0).y * 8, 8, 8);\n}\n")),(0,l.kt)("p",null,"Result:"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Changing Color",src:n(7882).Z})),(0,l.kt)("p",null,"You'll see a change. The snake changed color. Not only the head, but the complete snake! Once you've set a color, it stays that way. So if you want to change only the head, you have to change Color 1 again. Right before you draw the body."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-zig",metastring:"{2}","{2}":!0},"pub fn draw(this: *@This()) void {\n    w4.DRAW_COLORS.* = 0x0043;\n    for(this.body.constSlice()) |part| {\n        w4.rect(part.x * 8, part.y * 8, 8, 8);\n    }\n\n    w4.DRAW_COLORS.* = 0x0004;\n    w4.rect(this.body.get(0).x * 8, this.body.get(0).y * 8, 8, 8);\n}\n")),(0,l.kt)("p",null,"This changes the color back and adds the darker green as its outline."),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Snake with outline",src:n(2179).Z})))))}h.isMDXComponent=!0},6010:function(e,t,n){"use strict";function a(e){var t,n,o="";if("string"==typeof e||"number"==typeof e)o+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=a(e[t]))&&(o&&(o+=" "),o+=n);else for(t in e)e[t]&&(o&&(o+=" "),o+=t);return o}function o(){for(var e,t,n=0,o="";n<arguments.length;)(e=arguments[n++])&&(t=a(e))&&(o&&(o+=" "),o+=t);return o}n.d(t,{Z:function(){return o}})},7882:function(e,t){"use strict";t.Z="data:image/webp;base64,UklGRjYAAABXRUJQVlA4TCoAAAAvP8FPAA/wmPuX7F9pfv7jAWrbtmH8/9NOmzL2iP5PAEMkrCvv//f/Bx4="},2179:function(e,t){"use strict";t.Z="data:image/webp;base64,UklGRloAAABXRUJQVlA4TE4AAAAvP8FPABcgEEiYktjfZhUyaRsvbedf4B6BQKISz/4mC8x//FsCKGokSTmT7A9H6L0YJ6L/EyCLRRXr4wHnAXduyeI+of/pf/qf/qf/SXA="},6898:function(e,t){"use strict";t.Z="data:image/webp;base64,UklGRjYAAABXRUJQVlA4TCoAAAAvP8FPAA/wu/sf7V9tfv7jAWrbtmH8/9NOmzL2iP5PAEMkrCvv//f/Bx4="}}]);