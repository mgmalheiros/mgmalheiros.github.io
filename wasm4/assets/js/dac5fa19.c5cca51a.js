(self.webpackChunksite=self.webpackChunksite||[]).push([[5898],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return c},kt:function(){return f}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var u=r.createContext({}),s=function(e){var t=r.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=s(e.components);return r.createElement(u.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,u=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),d=s(n),f=a,g=d["".concat(u,".").concat(f)]||d[f]||p[f]||o;return n?r.createElement(g,l(l({ref:t},c),{},{components:n})):r.createElement(g,l({ref:t},c))}));function f(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,l=new Array(o);l[0]=d;var i={};for(var u in t)hasOwnProperty.call(t,u)&&(i[u]=t[u]);i.originalType=e,i.mdxType="string"==typeof e?e:a,l[1]=i;for(var s=2;s<o;s++)l[s]=n[s];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},6742:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r=n(9756),a=n(7294),o=n(3727),l=n(2263),i=n(3919),u=n(412),s=(0,a.createContext)({collectLink:function(){}}),c=n(4996),p=n(8780),d=["isNavLink","to","href","activeClassName","isActive","data-noBrokenLinkCheck","autoAddBaseUrl"];var f=function(e){var t,n,f=e.isNavLink,g=e.to,m=e.href,k=e.activeClassName,v=e.isActive,h=e["data-noBrokenLinkCheck"],y=e.autoAddBaseUrl,b=void 0===y||y,T=(0,r.Z)(e,d),w=(0,l.Z)().siteConfig,N=w.trailingSlash,x=w.baseUrl,E=(0,c.C)().withBaseUrl,P=(0,a.useContext)(s),O=g||m,C=(0,i.Z)(O),L=null==O?void 0:O.replace("pathname://",""),A=void 0!==L?(n=L,b&&function(e){return e.startsWith("/")}(n)?E(n):n):void 0;A&&C&&(A=(0,p.applyTrailingSlash)(A,{trailingSlash:N,baseUrl:x}));var j,S=(0,a.useRef)(!1),_=f?o.OL:o.rU,D=u.Z.canUseIntersectionObserver;(0,a.useEffect)((function(){return!D&&C&&null!=A&&window.docusaurus.prefetch(A),function(){D&&j&&j.disconnect()}}),[A,D,C]);var Z=null!==(t=null==A?void 0:A.startsWith("#"))&&void 0!==t&&t,M=!A||!C||Z;return A&&C&&!Z&&!h&&P.collectLink(A),M?a.createElement("a",Object.assign({href:A},O&&!C&&{target:"_blank",rel:"noopener noreferrer"},T)):a.createElement(_,Object.assign({},T,{onMouseEnter:function(){S.current||null==A||(window.docusaurus.preload(A),S.current=!0)},innerRef:function(e){var t,n;D&&e&&C&&(t=e,n=function(){null!=A&&window.docusaurus.prefetch(A)},(j=new window.IntersectionObserver((function(e){e.forEach((function(e){t===e.target&&(e.isIntersecting||e.intersectionRatio>0)&&(j.unobserve(t),j.disconnect(),n())}))}))).observe(t))},to:A||""},f&&{isActive:v,activeClassName:k}))}},3919:function(e,t,n){"use strict";function r(e){return!0===/^(\w*:|\/\/)/.test(e)}function a(e){return void 0!==e&&!r(e)}n.d(t,{b:function(){return r},Z:function(){return a}})},4996:function(e,t,n){"use strict";n.d(t,{C:function(){return o},Z:function(){return l}});var r=n(2263),a=n(3919);function o(){var e=(0,r.Z)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,n=void 0===t?"/":t,o=e.url;return{withBaseUrl:function(e,t){return function(e,t,n,r){var o=void 0===r?{}:r,l=o.forcePrependBaseUrl,i=void 0!==l&&l,u=o.absolute,s=void 0!==u&&u;if(!n)return n;if(n.startsWith("#"))return n;if((0,a.b)(n))return n;if(i)return t+n;var c=n.startsWith(t)?n:t+n.replace(/^\//,"");return s?e+c:c}(o,n,e,t)}}}function l(e,t){return void 0===t&&(t={}),(0,o().withBaseUrl)(e,t)}},9443:function(e,t,n){"use strict";var r=(0,n(7294).createContext)(void 0);t.Z=r},8802:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=t.trailingSlash,r=t.baseUrl;if(e.startsWith("#"))return e;if(void 0===n)return e;var a,o=e.split(/[#?]/)[0],l="/"===o||o===r?o:(a=o,n?function(e){return e.endsWith("/")?e:e+"/"}(a):function(e){return e.endsWith("/")?e.slice(0,-1):e}(a));return e.replace(o,l)}},8780:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.uniq=t.applyTrailingSlash=void 0;var a=n(8802);Object.defineProperty(t,"applyTrailingSlash",{enumerable:!0,get:function(){return r(a).default}});var o=n(9964);Object.defineProperty(t,"uniq",{enumerable:!0,get:function(){return r(o).default}})},9964:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return Array.from(new Set(e))}},2375:function(e,t,n){"use strict";n.d(t,{T:function(){return d},Z:function(){return f}});var r=n(7294),a=n(6742),o=n(5977),l=n(6010),i=n(9443);var u=function(){var e=(0,r.useContext)(i.Z);if(null==e)throw new Error('"useUserPreferencesContext" is used outside of "Layout" component.');return e},s={assemblyscript:"AssemblyScript",c:"C / C++",c3:"C3",d:"D",go:"Go",grain:"Grain",nelua:"Nelua",nim:"Nim",odin:"Odin",penne:"Penne",porth:"Porth",roland:"Roland",rust:"Rust",wat:"WebAssembly Text",zig:"Zig"};function c(e){return"string"==typeof e&&Object.prototype.hasOwnProperty.call(s,e)}function p(e){return(null!=e?e:"").trim().toLowerCase()}function d(e){var t=e.children,n=e.hidden,a=e.className;return r.createElement("div",{hidden:n,className:a},t)}function f(e){var t=r.Children.toArray(e.children),n=t.map((function(e){return e.props.value})),i=function(){var e=u(),t=e.tabGroupChoices,n=e.setTabGroupChoices,a=(0,r.useState)("assemblyscript"),o=a[0],l=a[1],i=function(e){var t=c(e);t?(l(e),n("language",e)):t||console.warn('MultilanguageCode: invalid code-lang received: "'+e+'"')},s=(0,r.useRef)(i);(0,r.useEffect)((function(){s.current=i}));var d="undefined"!=typeof window?window.location.search:"",f=t.language;return(0,r.useLayoutEffect)((function(){var e=p(f);c(e)&&l(e)}),[f]),(0,r.useEffect)((function(){var e=p(new URLSearchParams(d).get("code-lang"));c(e)&&s.current(e)}),[d]),{activeLang:o,updateLang:i}}().activeLang,d=(0,o.k6)(),f=n.includes(i)?i:n.includes("assemblyscript")?"assemblyscript":n[0],g=r.createElement("div",{className:"dropdown dropdown--hoverable dropdown--right"},r.createElement("a",{className:"navbar__link"},s[f]," "),r.createElement("ul",{className:"dropdown__menu text--left"},Object.entries(s).filter((function(e){return n.includes(e[0])})).map((function(e){var t=e[0],n=e[1],o=d.location.pathname+"?code-lang="+t+(d.location.hash||"#no-scroll");return r.createElement("li",{key:t},r.createElement(a.Z,{to:o,replace:!0,className:(0,l.Z)("dropdown__link",t===f&&"dropdown__link--active")},n))}))));return r.createElement("div",null,r.createElement("div",{className:"multilang"},g),r.createElement("div",null,t.map((function(e){return(0,r.cloneElement)(e,{key:e.props.value,hidden:e.props.value!==f})}))))}},364:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(7294),a=n(2375),o={"language-typescript":"assemblyscript","language-javascript":"assemblyscript","language-c":"c","language-c3":"c3","language-cpp":"c","language-d":"d","language-grain":"grain","language-lua":"nelua","language-nelua":"nelua","language-nim":"nim","language-roland":"roland","language-rust":"rust","language-go":"go","language-odin":"odin","language-penne":"penne","language-porth":"porth","language-wasm":"wat","language-zig":"zig"};function l(e){var t=r.Children.toArray(e.children).map((function(e,t){return r.createElement(a.T,{key:t,value:o[e.props.children.props.className]},e)}));return r.createElement(a.Z,null,t)}},9525:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return c},metadata:function(){return p},toc:function(){return d},default:function(){return g}});var r=n(2122),a=n(9756),o=(n(7294),n(3905)),l=n(2375),i=n(364),u=["components"],s={},c="Setting Color Palette",p={unversionedId:"tutorials/snake/setting-color-palette",id:"tutorials/snake/setting-color-palette",isDocsHomePage:!1,title:"Setting Color Palette",description:"The Default Color Palette",source:"@site/docs/tutorials/snake/setting-color-palette.md",sourceDirName:"tutorials/snake",slug:"/tutorials/snake/setting-color-palette",permalink:"/wasm4/docs/tutorials/snake/setting-color-palette",editUrl:"https://github.com/aduros/wasm4/edit/main/site/docs/tutorials/snake/setting-color-palette.md",version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Setup Your Project",permalink:"/wasm4/docs/tutorials/snake/setup-project"},next:{title:"Creating the Snake",permalink:"/wasm4/docs/tutorials/snake/creating-the-snake"}},d=[{value:"The Default Color Palette",id:"the-default-color-palette",children:[]},{value:"Picking a Color Palette",id:"picking-a-color-palette",children:[]},{value:"Setting in source",id:"setting-in-source",children:[]}],f={toc:d};function g(e){var t=e.components,n=(0,a.Z)(e,u);return(0,o.kt)("wrapper",(0,r.Z)({},f,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"setting-color-palette"},"Setting Color Palette"),(0,o.kt)("h2",{id:"the-default-color-palette"},"The Default Color Palette"),(0,o.kt)("p",null,"In WASM-4, you can set 4 colors to your liking. The default color palette looks like this:"),(0,o.kt)("div",{className:"row row--no-gutters"},(0,o.kt)("div",{className:"col col--2",style:{padding:"1.5rem",background:"#e0f8cf",color:"#000"}},"Color 1: #e0f8cf"),(0,o.kt)("div",{className:"col col--2",style:{padding:"1.5rem",background:"#86c06c",color:"#000"}},"Color 2: #86c06c"),(0,o.kt)("div",{className:"col col--2",style:{padding:"1.5rem",background:"#306850",color:"#fff"}},"Color 3: #306850"),(0,o.kt)("div",{className:"col col--2",style:{padding:"1.5rem",background:"#071821",color:"#fff"}},"Color 4: #071821")),(0,o.kt)("p",null,"It's inspired by the color palette of the original Gameboy. But you can set your own palette too."),(0,o.kt)("h2",{id:"picking-a-color-palette"},"Picking a Color Palette"),(0,o.kt)("p",null,"There are a lot of different color palettes available. One of the most famous is probably ",(0,o.kt)("a",{parentName:"p",href:"https://lospec.com/palette-list"},"https://lospec.com/palette-list"),"."),(0,o.kt)("p",null,"You can set the number of colors to 4 and get a lot of palettes presented. For this tutorial, I'll pick the ",(0,o.kt)("a",{parentName:"p",href:"https://lospec.com/palette-list/en4"},"EN4 Palette"),"."),(0,o.kt)("div",{className:"row row--no-gutters"},(0,o.kt)("div",{className:"col col--2",style:{padding:"1.5rem",background:"#fbf7f3",color:"#000"}},"Color 1: #fbf7f3"),(0,o.kt)("div",{className:"col col--2",style:{padding:"1.5rem",background:"#e5b083",color:"#000"}},"Color 2: #e5b083"),(0,o.kt)("div",{className:"col col--2",style:{padding:"1.5rem",background:"#426e5d",color:"#fff"}},"Color 3: #426e5d"),(0,o.kt)("div",{className:"col col--2",style:{padding:"1.5rem",background:"#20283d",color:"#fff"}},"Color 4: #20283d")),(0,o.kt)("p",null,'This palette provides enough "green" for the snake and a "not green" for the fruit. Also the background is fine.'),(0,o.kt)("h2",{id:"setting-in-source"},"Setting in source"),(0,o.kt)("p",null,"Unlike most other fantasy consoles, pretty much everything is done in code. Setting the color palette belongs to this category. But before you go and mess with the code, you should remove most of the existing code."),(0,o.kt)(i.Z,{mdxType:"MultiLanguageCode"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},'import * as w4 from "./wasm4";\n\nexport function update(): void {\n}\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-c"},'#include "wasm4.h"\n\nvoid update()\n{\n\n}\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-d"},"// TODO\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'package main\n\nimport "cart/w4"\n\n//go:export update\nfunc update() {\n}\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-lua"},'require "wasm4"\n\nlocal function update()\nend\n\n## setup_wasm4_callbacks(update)\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-nim"},"# TODO\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-odin"},"// TODO\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-porth"},"// TODO\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-rust"},'#[cfg(feature = "buddy-alloc")]\nmod alloc;\nmod wasm4;\n\n#[no_mangle]\nfn update() {\n}\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-wasm"},'(func (export "update")\n)\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-zig"},'const w4 = @import("wasm4.zig");\n\nexport fn update() void {}\n'))),(0,o.kt)("p",null,"The update function is required. Or WASM-4 won't be able to show anything. To set up the color palette, it's usually enough to do this once at the start of the game."),(0,o.kt)("p",null,'So in most cases, you\'d add a "start" function and export it too. WASM-4 will execute it once at the start.'),(0,o.kt)(l.Z,{mdxType:"MultiLanguage"},(0,o.kt)(l.T,{value:"assemblyscript",mdxType:"Page"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"export function start(): void {\n    store<u32>(w4.PALETTE, 0xfbf7f3, 0 * sizeof<u32>())\n    store<u32>(w4.PALETTE, 0xe5b083, 1 * sizeof<u32>())\n    store<u32>(w4.PALETTE, 0x426e5d, 2 * sizeof<u32>())\n    store<u32>(w4.PALETTE, 0x20283d, 3 * sizeof<u32>())\n}\n"))),(0,o.kt)(l.T,{value:"c",mdxType:"Page"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-c"},"void start() {\n    PALETTE[0] = 0xfbf7f3;\n    PALETTE[1] = 0xe5b083;\n    PALETTE[2] = 0x426e5d;\n    PALETTE[3] = 0x20283d;\n}\n"))),(0,o.kt)(l.T,{value:"d",mdxType:"Page"},"```d // TODO ```"),(0,o.kt)(l.T,{value:"go",mdxType:"Page"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},"//go:export start\nfunc start() {\n    w4.PALETTE[0] = 0xfbf7f3\n    w4.PALETTE[1] = 0xe5b083\n    w4.PALETTE[2] = 0x426e5d\n    w4.PALETTE[3] = 0x20283d\n}\n"))),(0,o.kt)(l.T,{value:"nelua",mdxType:"Page"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-lua"},'require "wasm4"\n\n-- in nelua we can place the "start" code at the top of the file\n$PALETTE = {\n  0xfbf7f3,\n  0xe5b083,\n  0x426e5d,\n  0x20283d\n}\n'))),(0,o.kt)(l.T,{value:"nim",mdxType:"Page"},(0,o.kt)("p",null,"// TODO")),(0,o.kt)(l.T,{value:"odin",mdxType:"Page"},(0,o.kt)("p",null,"// TODO")),(0,o.kt)(l.T,{value:"porth",mdxType:"Page"},(0,o.kt)("p",null,"// TODO")),(0,o.kt)(l.T,{value:"rust",mdxType:"Page"},(0,o.kt)("p",null,"Let's create a new file ",(0,o.kt)("inlineCode",{parentName:"p"},"palette.rs")," inside ",(0,o.kt)("inlineCode",{parentName:"p"},"src/")," directory with a helper\nfunction ",(0,o.kt)("inlineCode",{parentName:"p"},"set_palette"),". "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-rust"},"// src/palette.rs\nuse crate::wasm4;\n\npub fn set_palette(palette: [u32; 4]) {\n    unsafe {\n        *wasm4::PALETTE = palette;\n    }\n}\n")),(0,o.kt)("p",null,"We'll then use this function to customize the palette in ",(0,o.kt)("inlineCode",{parentName:"p"},"src/lib.rs"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-rust"},"mod palette; // Don't forget to add the module declaration!\n\n#[no_mangle]\nfn start() {\n    palette::set_palette([0xfbf7f3, 0xe5b083, 0x426e5d, 0x20283d]);\n}\n"))),(0,o.kt)(l.T,{value:"wat",mdxType:"Page"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-wasm"},';; We must explicitly import the memory, otherwise we won\'t be able to use any\n;; load or store instructions. This imports 1 page of memory (i.e. 64KiB).\n(import "env" "memory" (memory 1))\n\n(func (export "start")\n  (i32.store (global.get $PALETTE0) (i32.const 0xfbf7f3))\n  (i32.store (global.get $PALETTE1) (i32.const 0xe5b083))\n  (i32.store (global.get $PALETTE2) (i32.const 0x426e5d))\n  (i32.store (global.get $PALETTE3) (i32.const 0x20283d))\n)\n'))),(0,o.kt)(l.T,{value:"zig",mdxType:"Page"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-zig"},"export fn start() void {\n    w4.PALETTE.* = .{\n        0xfbf7f3,\n        0xe5b083,\n        0x426e5d,\n        0x20283d,\n    };\n}\n")))))}g.isMDXComponent=!0},6010:function(e,t,n){"use strict";function r(e){var t,n,a="";if("string"==typeof e||"number"==typeof e)a+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=r(e[t]))&&(a&&(a+=" "),a+=n);else for(t in e)e[t]&&(a&&(a+=" "),a+=t);return a}function a(){for(var e,t,n=0,a="";n<arguments.length;)(e=arguments[n++])&&(t=r(e))&&(a&&(a+=" "),a+=t);return a}n.d(t,{Z:function(){return a}})}}]);