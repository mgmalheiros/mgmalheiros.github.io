(self.webpackChunksite=self.webpackChunksite||[]).push([[5485],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return c},kt:function(){return m}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var u=r.createContext({}),s=function(e){var t=r.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=s(e.components);return r.createElement(u.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,u=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),d=s(n),m=a,f=d["".concat(u,".").concat(m)]||d[m]||p[m]||i;return n?r.createElement(f,l(l({ref:t},c),{},{components:n})):r.createElement(f,l({ref:t},c))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,l=new Array(i);l[0]=d;var o={};for(var u in t)hasOwnProperty.call(t,u)&&(o[u]=t[u]);o.originalType=e,o.mdxType="string"==typeof e?e:a,l[1]=o;for(var s=2;s<i;s++)l[s]=n[s];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},6742:function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});var r=n(9756),a=n(7294),i=n(3727),l=n(2263),o=n(3919),u=n(412),s=(0,a.createContext)({collectLink:function(){}}),c=n(4996),p=n(8780),d=["isNavLink","to","href","activeClassName","isActive","data-noBrokenLinkCheck","autoAddBaseUrl"];var m=function(e){var t,n,m=e.isNavLink,f=e.to,g=e.href,y=e.activeClassName,h=e.isActive,v=e["data-noBrokenLinkCheck"],k=e.autoAddBaseUrl,b=void 0===k||k,N=(0,r.Z)(e,d),w=(0,l.Z)().siteConfig,C=w.trailingSlash,E=w.baseUrl,P=(0,c.C)().withBaseUrl,A=(0,a.useContext)(s),O=f||g,T=(0,o.Z)(O),L=null==O?void 0:O.replace("pathname://",""),j=void 0!==L?(n=L,b&&function(e){return e.startsWith("/")}(n)?P(n):n):void 0;j&&T&&(j=(0,p.applyTrailingSlash)(j,{trailingSlash:C,baseUrl:E}));var x,S=(0,a.useRef)(!1),M=m?i.OL:i.rU,_=u.Z.canUseIntersectionObserver;(0,a.useEffect)((function(){return!_&&T&&null!=j&&window.docusaurus.prefetch(j),function(){_&&x&&x.disconnect()}}),[j,_,T]);var Z=null!==(t=null==j?void 0:j.startsWith("#"))&&void 0!==t&&t,D=!j||!T||Z;return j&&T&&!Z&&!v&&A.collectLink(j),D?a.createElement("a",Object.assign({href:j},O&&!T&&{target:"_blank",rel:"noopener noreferrer"},N)):a.createElement(M,Object.assign({},N,{onMouseEnter:function(){S.current||null==j||(window.docusaurus.preload(j),S.current=!0)},innerRef:function(e){var t,n;_&&e&&T&&(t=e,n=function(){null!=j&&window.docusaurus.prefetch(j)},(x=new window.IntersectionObserver((function(e){e.forEach((function(e){t===e.target&&(e.isIntersecting||e.intersectionRatio>0)&&(x.unobserve(t),x.disconnect(),n())}))}))).observe(t))},to:j||""},m&&{isActive:h,activeClassName:y}))}},3919:function(e,t,n){"use strict";function r(e){return!0===/^(\w*:|\/\/)/.test(e)}function a(e){return void 0!==e&&!r(e)}n.d(t,{b:function(){return r},Z:function(){return a}})},4996:function(e,t,n){"use strict";n.d(t,{C:function(){return i},Z:function(){return l}});var r=n(2263),a=n(3919);function i(){var e=(0,r.Z)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,n=void 0===t?"/":t,i=e.url;return{withBaseUrl:function(e,t){return function(e,t,n,r){var i=void 0===r?{}:r,l=i.forcePrependBaseUrl,o=void 0!==l&&l,u=i.absolute,s=void 0!==u&&u;if(!n)return n;if(n.startsWith("#"))return n;if((0,a.b)(n))return n;if(o)return t+n;var c=n.startsWith(t)?n:t+n.replace(/^\//,"");return s?e+c:c}(i,n,e,t)}}}function l(e,t){return void 0===t&&(t={}),(0,i().withBaseUrl)(e,t)}},9443:function(e,t,n){"use strict";var r=(0,n(7294).createContext)(void 0);t.Z=r},8802:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=t.trailingSlash,r=t.baseUrl;if(e.startsWith("#"))return e;if(void 0===n)return e;var a,i=e.split(/[#?]/)[0],l="/"===i||i===r?i:(a=i,n?function(e){return e.endsWith("/")?e:e+"/"}(a):function(e){return e.endsWith("/")?e.slice(0,-1):e}(a));return e.replace(i,l)}},8780:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.uniq=t.applyTrailingSlash=void 0;var a=n(8802);Object.defineProperty(t,"applyTrailingSlash",{enumerable:!0,get:function(){return r(a).default}});var i=n(9964);Object.defineProperty(t,"uniq",{enumerable:!0,get:function(){return r(i).default}})},9964:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return Array.from(new Set(e))}},2375:function(e,t,n){"use strict";n.d(t,{T:function(){return d},Z:function(){return m}});var r=n(7294),a=n(6742),i=n(5977),l=n(6010),o=n(9443);var u=function(){var e=(0,r.useContext)(o.Z);if(null==e)throw new Error('"useUserPreferencesContext" is used outside of "Layout" component.');return e},s={assemblyscript:"AssemblyScript",c:"C / C++",c3:"C3",d:"D",go:"Go",grain:"Grain",nelua:"Nelua",nim:"Nim",odin:"Odin",penne:"Penne",porth:"Porth",roland:"Roland",rust:"Rust",wat:"WebAssembly Text",zig:"Zig"};function c(e){return"string"==typeof e&&Object.prototype.hasOwnProperty.call(s,e)}function p(e){return(null!=e?e:"").trim().toLowerCase()}function d(e){var t=e.children,n=e.hidden,a=e.className;return r.createElement("div",{hidden:n,className:a},t)}function m(e){var t=r.Children.toArray(e.children),n=t.map((function(e){return e.props.value})),o=function(){var e=u(),t=e.tabGroupChoices,n=e.setTabGroupChoices,a=(0,r.useState)("assemblyscript"),i=a[0],l=a[1],o=function(e){var t=c(e);t?(l(e),n("language",e)):t||console.warn('MultilanguageCode: invalid code-lang received: "'+e+'"')},s=(0,r.useRef)(o);(0,r.useEffect)((function(){s.current=o}));var d="undefined"!=typeof window?window.location.search:"",m=t.language;return(0,r.useLayoutEffect)((function(){var e=p(m);c(e)&&l(e)}),[m]),(0,r.useEffect)((function(){var e=p(new URLSearchParams(d).get("code-lang"));c(e)&&s.current(e)}),[d]),{activeLang:i,updateLang:o}}().activeLang,d=(0,i.k6)(),m=n.includes(o)?o:n.includes("assemblyscript")?"assemblyscript":n[0],f=r.createElement("div",{className:"dropdown dropdown--hoverable dropdown--right"},r.createElement("a",{className:"navbar__link"},s[m]," "),r.createElement("ul",{className:"dropdown__menu text--left"},Object.entries(s).filter((function(e){return n.includes(e[0])})).map((function(e){var t=e[0],n=e[1],i=d.location.pathname+"?code-lang="+t+(d.location.hash||"#no-scroll");return r.createElement("li",{key:t},r.createElement(a.Z,{to:i,replace:!0,className:(0,l.Z)("dropdown__link",t===m&&"dropdown__link--active")},n))}))));return r.createElement("div",null,r.createElement("div",{className:"multilang"},f),r.createElement("div",null,t.map((function(e){return(0,r.cloneElement)(e,{key:e.props.value,hidden:e.props.value!==m})}))))}},364:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(7294),a=n(2375),i={"language-typescript":"assemblyscript","language-javascript":"assemblyscript","language-c":"c","language-c3":"c3","language-cpp":"c","language-d":"d","language-grain":"grain","language-lua":"nelua","language-nelua":"nelua","language-nim":"nim","language-roland":"roland","language-rust":"rust","language-go":"go","language-odin":"odin","language-penne":"penne","language-porth":"porth","language-wasm":"wat","language-zig":"zig"};function l(e){var t=r.Children.toArray(e.children).map((function(e,t){return r.createElement(a.T,{key:t,value:i[e.props.children.props.className]},e)}));return r.createElement(a.Z,null,t)}},9686:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return u},contentTitle:function(){return s},metadata:function(){return c},toc:function(){return p},default:function(){return m}});var r=n(2122),a=n(9756),i=(n(7294),n(3905)),l=n(364),o=["components"],u={},s="Multiplayer",c={unversionedId:"guides/multiplayer",id:"guides/multiplayer",isDocsHomePage:!1,title:"Multiplayer",description:"WASM-4 supports realtime multiplayer of up to 4 players, either locally or online.",source:"@site/docs/guides/multiplayer.md",sourceDirName:"guides",slug:"/guides/multiplayer",permalink:"/wasm4/docs/guides/multiplayer",editUrl:"https://github.com/aduros/wasm4/edit/main/site/docs/guides/multiplayer.md",version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Saving Data",permalink:"/wasm4/docs/guides/saving-data"},next:{title:"Distribution",permalink:"/wasm4/docs/guides/distribution"}},p=[{value:"Local Multiplayer",id:"local-multiplayer",children:[]},{value:"Netplay",id:"netplay",children:[{value:"The <code>NETPLAY</code> memory register",id:"the-netplay-memory-register",children:[]}]}],d={toc:p};function m(e){var t=e.components,n=(0,a.Z)(e,o);return(0,i.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"multiplayer"},"Multiplayer"),(0,i.kt)("p",null,"WASM-4 supports realtime multiplayer of up to 4 players, either locally or online."),(0,i.kt)("p",null,"Detecting ",(0,i.kt)("a",{parentName:"p",href:"/docs/guides/user-input#gamepad"},"gamepad input")," for Player 2 is the same as usual, but instead of\n",(0,i.kt)("inlineCode",{parentName:"p"},"GAMEPAD1"),", you read from ",(0,i.kt)("inlineCode",{parentName:"p"},"GAMEPAD2"),". For Players 3 and 4, ",(0,i.kt)("inlineCode",{parentName:"p"},"GAMEPAD3")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"GAMEPAD4"),"."),(0,i.kt)("h2",{id:"local-multiplayer"},"Local Multiplayer"),(0,i.kt)("p",null,"Local multiplayer is where everyone is playing on the same computer. To play local multiplayer, you\ncan connect multiple physical USB controllers. Xbox or PlayStation controllers are known to work\nbest."),(0,i.kt)("p",null,"If all you have is a keyboard, up to 3 players can be controlled from one keyboard using these keys:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Player #"),(0,i.kt)("th",{parentName:"tr",align:null},"Directions"),(0,i.kt)("th",{parentName:"tr",align:null},"X button"),(0,i.kt)("th",{parentName:"tr",align:null},"Z button"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1"),(0,i.kt)("td",{parentName:"tr",align:null},"Arrows"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},".")," (period)"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},",")," (comma)")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"2"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"ESDF")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"A")," or ",(0,i.kt)("inlineCode",{parentName:"td"},"Q")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"Tab")," or ",(0,i.kt)("inlineCode",{parentName:"td"},"LShift"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"3"),(0,i.kt)("td",{parentName:"tr",align:null},"Numpad ",(0,i.kt)("inlineCode",{parentName:"td"},"8456")),(0,i.kt)("td",{parentName:"tr",align:null},"Numpad ",(0,i.kt)("inlineCode",{parentName:"td"},"*")," or ",(0,i.kt)("inlineCode",{parentName:"td"},".")),(0,i.kt)("td",{parentName:"tr",align:null},"Numpad ",(0,i.kt)("inlineCode",{parentName:"td"},"-")," or ",(0,i.kt)("inlineCode",{parentName:"td"},"Enter"))))),(0,i.kt)("p",null,"This key layout is designed to fit many hands on one keyboard somewhat comfortably."),(0,i.kt)("h2",{id:"netplay"},"Netplay"),(0,i.kt)("p",null,"Netplay connects gamepad inputs over the Internet using WebRTC. WASM-4 implements ",(0,i.kt)("a",{parentName:"p",href:"https://www.youtube.com/watch?v=0NLe4IpdS1w"},"rollback\nnetcode")," to keep games fast and responsive."),(0,i.kt)("p",null,"Hosting a netplay game is as easy as copy and pasting a link."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"While playing any cart, press Enter to open the WASM-4 menu."),(0,i.kt)("li",{parentName:"ol"},'Select "Copy Netplay URL". An invite link (like ',(0,i.kt)("inlineCode",{parentName:"li"},"https://wasm4.org/netplay/#ABCDEF"),") will be\ncopied to your clipboard for you to send to a friend."),(0,i.kt)("li",{parentName:"ol"},"When your friend clicks your link, they'll instantly join your game.")),(0,i.kt)("p",null,"All WASM-4 games that support local multiplayer automatically support netplay. There are no\nadditional steps developers need to take to make their games netplay-ready."),(0,i.kt)("p",null,"There are currently some caveats to keep in mind:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Mouse input is disabled during netplay."),(0,i.kt)("li",{parentName:"ul"},"State saving/loading and cart reset is currently disabled during netplay."),(0,i.kt)("li",{parentName:"ul"},"Netplay is new and there may be bugs, please ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/aduros/wasm4/issues/new"},"report\nissues"),"!")),(0,i.kt)("h3",{id:"the-netplay-memory-register"},"The ",(0,i.kt)("inlineCode",{parentName:"h3"},"NETPLAY")," memory register"),(0,i.kt)("p",null,"WASM-4 exposes the state of netplay to the cart via the ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/memory#netplay"},(0,i.kt)("inlineCode",{parentName:"a"},"NETPLAY")),"\nmemory register."),(0,i.kt)("p",null,"Reading this register is not required to implement netplay, but it can be used to implement advanced\nfeatures such as non-shared screen multiplayer:"),(0,i.kt)(l.Z,{mdxType:"MultiLanguageCode"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-c"},"// If netplay is active\nif (*NETPLAY & 0b100) {\n    int playerIdx = *NETPLAY & 0b011;\n    // Render the game from playerIdx's perspective\n    // ...\n}\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-c3"},"// If netplay is active\nif (*w4::NETPLAY & 0b100) \n{\n    int player_idx = *w4::NETPLAY & 0b011;\n    // Render the game from player_idx's perspective\n    // ...\n}\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-penne"},"// If netplay is active\nif NETPLAY & 0b100\n{\n    var player_idx = NETPLAY & 0b011;\n    // Render the game from playerIdx's perspective\n    // ...\n}\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-rust"},"unsafe {\n    // If netplay is active\n    if *NETPLAY & 0b100 != 0 {\n        let player_idx = *NETPLAY & 0b011;\n        // Render the game from player_idx's perspective\n        // ...\n    }\n}\n"))),(0,i.kt)("p",null,"This is a powerful feature enabling games with hidden information, like card games, strategy games,\nand first person shooters. However, caution must be taken by developers to not introduce\ndesynchronization. In other words, the netplay player index should only be used to adjust how a\nframe is rendered, and not affect game logic. Each connected player must run the same game logic for\nall players in order to prevent desyncs."))}m.isMDXComponent=!0},6010:function(e,t,n){"use strict";function r(e){var t,n,a="";if("string"==typeof e||"number"==typeof e)a+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=r(e[t]))&&(a&&(a+=" "),a+=n);else for(t in e)e[t]&&(a&&(a+=" "),a+=t);return a}function a(){for(var e,t,n=0,a="";n<arguments.length;)(e=arguments[n++])&&(t=r(e))&&(a&&(a+=" "),a+=t);return a}n.d(t,{Z:function(){return a}})}}]);